{% extends "base.html" %}
{% load static %}

{% block content %}
<h1 style="text-align:center; margin-top:30px; font-weight:700; color:#333;">
  CatÃ¡logo de Productos
</h1>

{% if user.is_staff %}
<div style="text-align:center; margin:25px 0;">
  <a href="{% url 'catalog:crear' %}" 
     style="background-color:#198754; color:white; padding:12px 22px; 
            border-radius:8px; text-decoration:none; font-weight:500;">
     â• Agregar producto
  </a>
</div>
{% endif %}

<div style="
  display:grid; 
  grid-template-columns:repeat(auto-fill,minmax(250px,1fr)); 
  gap:20px; 
  padding:20px;">
  
  {% for producto in productos %}
    <div style="
      border:1px solid #ddd; 
      border-radius:12px; 
      overflow:hidden; 
      box-shadow:0 2px 8px rgba(0,0,0,0.08); 
      background:white;
      transition:transform 0.2s ease;">
      
      <a href="{% url 'catalog:detalle' producto.pk %}" style="text-decoration:none;">
        {% if producto.image %}
          <img src="{{ producto.image.url }}" alt="{{ producto.name }}" 
               style="width:100%; height:200px; object-fit:cover;">
        {% else %}
          <img src="https://via.placeholder.com/400x200?text=Sin+Imagen" 
               alt="Sin imagen" 
               style="width:100%; height:200px; object-fit:cover;">
        {% endif %}
      </a>

      <div style="padding:15px;">
        <h3 style="margin:0; color:#212529;">{{ producto.name }}</h3>

        <p style="font-weight:bold; margin:5px 0; color:#0d6efd;">
          ${{ producto.price }}
        </p>

        <p style="color:#555;">{{ producto.description|truncatechars:100 }}</p>

        <a href="{% url 'catalog:agregar_carrito' producto.pk %}" 
           style="display:inline-block; margin-top:10px; 
                  background-color:#0d6efd; color:white; 
                  padding:8px 12px; border-radius:6px; text-decoration:none; 
                  font-weight:500;">
          ğŸ›’ Agregar a Canasta
        </a>

        {% if user.is_staff %}
          <div style="margin-top:10px;">
            <a href="{% url 'catalog:editar' producto.pk %}" 
               style="margin-right:10px; color:#198754; text-decoration:none; font-weight:500;">
              âœï¸ Editar
            </a>
            <a href="{% url 'catalog:eliminar' producto.pk %}" 
               style="color:#dc3545; text-decoration:none; font-weight:500;">
              ğŸ—‘ï¸ Eliminar
            </a>
          </div>
        {% endif %}
      </div>
    </div>
  {% empty %}
    <p style="grid-column:1 / -1; text-align:center; color:#777;">
      No hay productos disponibles.
    </p>
  {% endfor %}
</div>

{% if is_paginated %}
<div style="text-align:center; margin:25px;">
  {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}" style="margin-right:10px; color:#0d6efd; text-decoration:none;">
      Â« Anterior
    </a>
  {% endif %}
  <span style="color:#555;">
    PÃ¡gina {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
  </span>
  {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}" style="margin-left:10px; color:#0d6efd; text-decoration:none;">
      Siguiente Â»
    </a>
  {% endif %}
</div>
{% endif %}
{% endblock %}
